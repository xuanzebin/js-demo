<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>肥宅快乐导航</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <header></header>
    <main style="background-image: url(./img/wallhaven-630087.jpg)">
        <div class="mask"></div>
        <div class="wrapper" id="main">
            <div class="promptMessage" id="message">提示：该按键没有被编辑任何网址!!</div> 
        </div>
    </main>
    <footer></footer>
    <script>
        key = { 
            '0':{0:'q',1:'w',2:'e',3:'r',4:'t',5:'y',6:'u',7:'i',8:'o',9:'p',length:10},
            '1':{0:'a',1:'s',2:'d',3:'f',4:'g',5:'h',6:'j',7:'k',8:'l',length:9},
            '2':{0:'z',1:'x',2:'c',3:'v',4:'b',5:'n',6:'m',length:7},
            'length':3
        }
        hash = {
            'q':'qq.com',
            'w':'weibo.com',
            'y':'youtube.com',
            'x':'xiedaimala.com',
            'l':'lol.qq.com'
        }
        hashInLocalStorage = JSON.parse(localStorage.getItem('web')||'null')
        if (hashInLocalStorage) {
            hash = hashInLocalStorage
        }
        index = 0
        while (index < key['length']) {
            div = document.createElement('div')
            main.appendChild(div)
            index2 = 0
            while (index2 < key[index]['length']) {
                kbd = document.createElement('kbd')
                button = document.createElement('button')
                span = document.createElement('span')
                img = document.createElement('img')
                img.className = "ico"
                if (hash[key[index][index2]]) {
                    img.src = "http://" + hash[key[index][index2]] + "/favicon.ico"
                } else {
                    img.src = "http://i.loli.net/2017/11/10/5a05afbc5e183.png"
                }
                span.textContent = key[index][index2]
                kbd.id = key[index][index2]+key[index][index2]
                button.id = key[index][index2]
                img.id = 'img' + button.id
                button.textContent = '编辑'
                button.onclick = function(press) {
                    buttonPress = press.target
                    keys = buttonPress.id
                    websiteNew = prompt('请输入你要编辑的新网址：')
                    hash[keys] = websiteNew
                    localStorage.setItem('web',JSON.stringify(hash))
                    if (hash[keys]) {
                        document.getElementById('img'+keys).src = "http://" + hash[keys] + "/favicon.ico"
                    }
                }
                kbd.appendChild(img)
                kbd.appendChild(button) 
                kbd.appendChild(span)
                div.appendChild(kbd)
                index2 = index2+1
            }
            index = index+1
        }
        document.onkeypress = function(inputPress) {
            x = inputPress.key
            website = hash[x]
            if (website != undefined) {
                window.open('http://' + website,'_blank')
            } else {
                document.getElementById(x + x).style = "background:white;box-shadow: 0px 0px 0px 1px white,0 0 0 2px white;margin-bottom:4px;vertical-align: bottom;"
                message.style = "color:black;"
                setTimeout('document.getElementById(x+x).style="background: linear-gradient(to bottom, #282828 0%,#111111 100%);box-shadow: 0px 0px 0px 1px #1A1B1C,0 0 0 2px #1F2020,0 3px 4px 2px #080808;"',100)
                setTimeout('message.style="color:transparent;"',2000)
            }
        }
    </script>
</body>
</html>